/*
Admin Approval
=====================
IdentityServiceExtensions contains the authorization policy for photo moderation
which is currently commented out

AdminController has all of the AuthPolicies commented out above the controller methods
for approving/rejecting photos etc.

photo-editor component calls the admin service methods to approve photos when added to bypass
the approval process. Remove the photos array and the two subscription where commented to reenable
======================



inside of register -- AccountController
=====================
using var hmac = new HMACSHA512();

user.PasswordHash = hmac.ComputeHash(Encoding.UTF8.GetBytes(registerDto.Password));
user.PasswordSalt = hmac.Key;


inside of login -- AccountController
===============
using var hmac = new HMACSHA512(user.PasswordSalt);

var computedHash = hmac.ComputeHash(Encoding.UTF8.GetBytes(loginDto.Password));

for (int i = 0; i < computedHash.Length; i++)
{
    if (computedHash[i] != user.PasswordHash[i]) return Unauthorized("Invalid Password");
}


inside of Seed for each user
===============================
using var hmac = new HMACSHA512();

user.PasswordHash = hmac.ComputeHash(Encoding.UTF8.GetBytes("asd"));
user.PasswordSalt = hmac.Key;

template reference variable #var


{
    "gender": "male",
    "username": "tim",
    "knownAs": "tim",
    "dateOfBirth": "1985-01-23",
    "city": "London",
    "country": "UK",
    "password": "Inkink123!"
}

{
        "id": 0,
        "eventId": "vvG18Z9FT4qKtq",
        "artistName": "Rainbow Kitten Surprise",
        "eventName": "Rainbow Kitten Surprise",
        "eventDate": "2022-12-04T00:00:00Z",
        "city": "Chicago",
        "venue": "Byline Bank Aragon Ballroom"
    }



    {
        "id": 0,
        "eventId": "G5vZZ98pbrxak",
        "artistName": "Drake White",
        "eventName": "Drake White",
        "eventDate": "2022-11-06T01:00:00Z",
        "city": "Niagara Falls",
        "venue": "The Avalon Theatre At Niagara Fallsview Casino Resort"
    }





*/

/*
From ConcertsController
        // Concert is in the db and the user has a list of UserConcert
        if (concert != null && user.UserConcert != null)
        {
            // Possible change to repo method GetUserConcert..Concerts.Where(concertId == eventId).Select(UserConcert).Where(uc.concertId == User.UserConcert.concertId)
            // ========================================================================================================
            // Check each of the user's UserConcert and return if the concert already exists in their list
            foreach (UserConcert userConcert in user.UserConcert)
            {
                if (userConcert.ConcertId == concert.Id) return BadRequest("You already like this concert");
            }
        }


        [HttpGet("user-concerts")]
        public async Task<ActionResult<IEnumerable<ConcertDto>>> GetUserConcert([FromQuery]ConcertParams concertParams)
        {
            //userid, concertid, OrderBy
            concertParams.UserId = User.GetUserId();
            var concerts = await _unitOfWork.ConcertsRepository.GetUserConcert(concertParams);

            Response.AddPaginationHeader(concerts.CurrentPage, concerts.PageSize, 
                concerts.TotalCount, concerts.TotalPages);

            return Ok(concerts);
        }

ConcertRepo

public async Task<PagedList<ConcertDto>> GetUserConcert(ConcertParams concertParams)
        {
            // First grab a list of all of the concerts from the concert repo and map them to a dto
            var concerts = _context.Concerts 
                .OrderBy(c => c.Id)
                .ProjectTo<ConcertDto>(_mapper.ConfigurationProvider)
                .AsQueryable();

            // Then get the user requesting their list of concerts, and select their list and project them to dto's
            var UserConcert = _context.Users 
                .Include(c => c.Concerts)
                .Where(x => x.Id == concertParams.UserId)
                .SelectMany(c => c.Concerts)
                .ProjectTo<ConcertDto>(_mapper.ConfigurationProvider);
            
            // Join the two tables based on the matching Id numbers (different from the event id, which is provided by ticketmaster)
            var query = 
                from concert in concerts
                join userConcert in UserConcert on concert.Id equals userConcert.Id
                select new ConcertDto
            {
                Id = concert.Id,
                EventId = concert.EventId,
                ArtistName = concert.ArtistName,
                EventName = concert.EventName,
                EventDate = concert.EventDate,
                City = concert.City,
                Venue = concert.Venue
            };

            return await PagedList<ConcertDto>.CreateAsync(query, concertParams.PageNumber, concertParams.PageSize);
        }

Task<PagedList<ConcertDto>> GetUserConcert(ConcertParams concertParams);



SELECT * FROM albums JOIN artists ON albums.artist_id = artists.id;



{
        "id": 0,
        "eventId": "vvG18Z93RO1xYz",
        "artistName": "Live Nation Club Pass",
        "eventName": "Live Nation Club Pass: BYLINE BANK ARAGON BALLROOM",
        "eventDate": "2023-01-01T05:59:00Z",
        "city": "Chicago",
        "venue": "Byline Bank Aragon Ballroom"
    },
    {
        "id": 0,
        "eventId": "vvG18Z9GDkNNll",
        "artistName": "MÅNESKIN",
        "eventName": " MÅNESKIN: THE LOUD KIDS TOUR",
        "eventDate": "2022-11-18T01:00:00Z",
        "city": "Chicago",
        "venue": "Byline Bank Aragon Ballroom"
    },
    {
        "id": 0,
        "eventId": "vvG18Z9GDbLfd9",
        "artistName": "El Tri",
        "eventName": "El Tri",
        "eventDate": "2022-11-24T01:00:00Z",
        "city": "Chicago",
        "venue": "Byline Bank Aragon Ballroom"
    },
    {
        "id": 0,
        "eventId": "vvG18Z9fgo77dk",
        "artistName": "Lewis Capaldi",
        "eventName": "Lewis Capaldi",
        "eventDate": "2023-04-20T01:00:00Z",
        "city": "Chicago",
        "venue": "Byline Bank Aragon Ballroom"
    },
    {
        "id": 0,
        "eventId": "vvG18Z9fV8v0FV",
        "artistName": "Maggie Rogers",
        "eventName": "Maggie Rogers: The Feral Joy Tour",
        "eventDate": "2023-02-18T01:30:00Z",
        "city": "Chicago",
        "venue": "Byline Bank Aragon Ballroom"
    },
    {
        "id": 0,
        "eventId": "vvG18Z93NLOSvN",
        "artistName": "Q101 Twisted Xmas",
        "eventName": "Twisted Xmas with The 1975",
        "eventDate": "2022-12-10T01:00:00Z",
        "city": "Chicago",
        "venue": "Byline Bank Aragon Ballroom"
    },
    {
        "id": 0,
        "eventId": "vvG18Z9FT4qKtq",
        "artistName": "Rainbow Kitten Surprise",
        "eventName": "Rainbow Kitten Surprise",
        "eventDate": "2022-12-04T01:30:00Z",
        "city": "Chicago",
        "venue": "Byline Bank Aragon Ballroom"
    },
    {
        "id": 0,
        "eventId": "vvG18Z9GFKv4c7",
        "artistName": "Carly Rae Jepsen",
        "eventName": "Carly Rae Jepsen: The So Nice Tour",
        "eventDate": "2022-11-06T00:30:00Z",
        "city": "Chicago",
        "venue": "Byline Bank Aragon Ballroom"
    },
    {
        "id": 0,
        "eventId": "vvG18Z9fodnftQ",
        "artistName": "keshi",
        "eventName": "Keshi: Hell & Back Tour",
        "eventDate": "2023-03-25T00:30:00Z",
        "city": "Chicago",
        "venue": "Byline Bank Aragon Ballroom"
    },
    {
        "id": 0,
        "eventId": "vvG18Z9KgkxVxY",
        "artistName": "Omar Apollo",
        "eventName": "Omar Apollo - The Prototype Tour",
        "eventDate": "2022-12-01T01:45:00Z",
        "city": "Chicago",
        "venue": "Byline Bank Aragon Ballroom"
    },
    {
        "id": 0,
        "eventId": "vvG18Z9p5k-xxT",
        "artistName": "Panteon Rococo",
        "eventName": "Panteon Rococo",
        "eventDate": "2022-12-11T01:00:00Z",
        "city": "Chicago",
        "venue": "Byline Bank Aragon Ballroom"
    },
    {
        "id": 0,
        "eventId": "vvG18Z93NqKwHY",
        "artistName": "Q101 Twisted Xmas",
        "eventName": "Twisted Xmas with Jack White",
        "eventDate": "2022-12-09T01:00:00Z",
        "city": "Chicago",
        "venue": "Byline Bank Aragon Ballroom"
    },
    {
        "id": 0,
        "eventId": "vvG18Z94ftkfgi",
        "artistName": "Rebelution",
        "eventName": "Rebelution: Good Vibes Summer Tour 2023",
        "eventDate": "2023-07-02T01:30:00Z",
        "city": "Chicago",
        "venue": "Byline Bank Aragon Ballroom"
    },
    {
        "id": 0,
        "eventId": "vvG18Z9f38H-10",
        "artistName": "Purple Disco Machine",
        "eventName": "Purple Disco Machine: Disco Extravaganza",
        "eventDate": "2023-01-01T03:00:00Z",
        "city": "Chicago",
        "venue": "Byline Bank Aragon Ballroom"
    },
    {
        "id": 0,
        "eventId": "vvG18Z9GlGaPv9",
        "artistName": "bbno$",
        "eventName": "Yung Gravy & bbno$: Baby Gravy, The Tour",
        "eventDate": "2022-11-23T02:00:00Z",
        "city": "Chicago",
        "venue": "Byline Bank Aragon Ballroom"
    },
    {
        "id": 0,
        "eventId": "vvG18Z9fb7C4jC",
        "artistName": "J.I.D",
        "eventName": "J.I.D & Smino - Luv Is 4ever Tour",
        "eventDate": "2023-03-21T23:30:00Z",
        "city": "Chicago",
        "venue": "Byline Bank Aragon Ballroom"
    },
    {
        "id": 0,
        "eventId": "vvG18Z93NqdeH8",
        "artistName": "Q101 Twisted Xmas",
        "eventName": "Twisted Xmas with Portugal. The Man",
        "eventDate": "2022-12-07T01:00:00Z",
        "city": "Chicago",
        "venue": "Byline Bank Aragon Ballroom"
    },
    {
        "id": 0,
        "eventId": "vvG18Z9Cf_tfqz",
        "artistName": "Amon Amarth",
        "eventName": "Amon Amarth - The Great Heathen Tour with Special Guests",
        "eventDate": "2022-11-27T00:30:00Z",
        "city": "Chicago",
        "venue": "Byline Bank Aragon Ballroom"
    },
    {
        "id": 0,
        "eventId": "vvG18Z9o53WVAg",
        "artistName": "Zeds Dead",
        "eventName": "Deadbeats featuring Zeds Dead plus Special Guests",
        "eventDate": "2022-12-18T03:00:00Z",
        "city": "Chicago",
        "venue": "Byline Bank Aragon Ballroom"
    },
    {
        "id": 0,
        "eventId": "vvG18Z9o53w7Ah",
        "artistName": "Zeds Dead",
        "eventName": "Deadbeats featuring Zeds Dead plus Special Guests",
        "eventDate": "2022-12-17T03:00:00Z",
        "city": "Chicago",
        "venue": "Byline Bank Aragon Ballroom"
    }







*/

